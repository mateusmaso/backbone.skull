// hipbone
// ------------------
// v1.0.0
//
// Copyright (c) 2012-2015 Mateus Maso
// Distributed under MIT license
//
// http://github.com/mateusmaso/hipbone

!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){window.Hipbone={VERSION:"1.0.0",I18n:a("./hipbone/i18n"),View:a("./hipbone/view"),Model:a("./hipbone/model"),Route:a("./hipbone/route"),Module:a("./hipbone/module"),Router:a("./hipbone/router"),History:a("./hipbone/history"),Storage:a("./hipbone/storage"),Collection:a("./hipbone/collection"),Application:a("./hipbone/application"),IdentityMap:a("./hipbone/identity_map")}}).call(this)},{"./hipbone/application":2,"./hipbone/collection":14,"./hipbone/history":23,"./hipbone/i18n":24,"./hipbone/identity_map":25,"./hipbone/model":26,"./hipbone/module":34,"./hipbone/route":35,"./hipbone/router":41,"./hipbone/storage":44,"./hipbone/view":45}],2:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d=a("./module"),b.exports=c=function(b){function c(a,b){null==a&&(a={}),null==b&&(b={}),this.initializeAjax(),this.initializeState(_.extend({assets:{}},a)),this.initializeLocale(b.locale),this.initializeInitializers(),this.router=new Hipbone.Router({title:this.title}),this.storage=new Hipbone.Storage({prefix:this.prefix}),this.runInitializers(b),this.initialize(b)}return e(c,b),c.include(Backbone.Events),c.include(a("./application/ajax")),c.include(a("./application/state")),c.include(a("./application/locale")),c.include(a("./application/initializers")),c.prototype.initialize=function(a){null==a&&(a={})},c.prototype.run=function(){return this.router.start(),this.trigger("run")},c.register("Application"),c}(d)}).call(this)},{"./application/ajax":3,"./application/initializers":4,"./application/locale":11,"./application/state":13,"./module":34}],3:[function(a,b,c){(function(){var a=[].slice;b.exports={initializeAjax:function(){return this.host||(this.host=""),this.headers||(this.headers={})},ajax:function(a){return null==a&&(a={}),this.ajaxHandle(Backbone.ajax(this.ajaxSettings(a)))},ajaxHandle:function(b){return b.done(function(b){return function(){return b.trigger.apply(b,["ajaxSuccess"].concat(a.call(arguments)))}}(this)),b.fail(function(b){return function(){return b.trigger.apply(b,["ajaxError"].concat(a.call(arguments)))}}(this)),b},ajaxUrl:function(a){return""+this.host+a},ajaxHeaders:function(){var a,b,c,d;b={},c=this.headers;for(a in c)d=c[a],_.isFunction(d)&&(d=d.apply(this)),b[a]=d;return b},ajaxSettings:function(a){return null==a&&(a={}),a.url=this.ajaxUrl(a.url),a.headers=_.extend({},a.headers,this.ajaxHeaders()),"POST"===a.type&&(a.dataType="json",a.contentType="application/json",a.data=JSON.stringify(a.data)),a.beforeSend=_.catenate(function(a,b){return null==b&&(b={}),a.settings=b},a.beforeSend),a}}}).call(this)},{}],4:[function(a,b,c){(function(){b.exports={initializeInitializers:function(){return this.initializers||(this.initializers=[]),this.initializers.unshift(a("./initializers/parse_body")),this.initializers.unshift(a("./initializers/parse_model")),this.initializers.unshift(a("./initializers/link_bridge")),this.initializers.unshift(a("./initializers/prevent_form")),this.initializers.unshift(a("./initializers/register_helpers"))},runInitializers:function(a){var b,c,d,e,f;for(e=this.initializers,f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(c.apply(this,[a]));return f}}}).call(this)},{"./initializers/link_bridge":5,"./initializers/parse_body":6,"./initializers/parse_model":7,"./initializers/prevent_form":9,"./initializers/register_helpers":10}],5:[function(a,b,c){(function(){b.exports=function(){return $("body").on("click","a:not([bypass])",function(a){return function(b){var c;return b.ctrlKey||b.metaKey||a.router.history.location.hostname!==b.currentTarget.hostname||$(b.currentTarget).attr("target")||!(c=$(b.currentTarget).attr("href"))?void 0:(b.preventDefault(),a.router.navigate(c,{trigger:!0}))}}(this))}}).call(this)},{}],6:[function(a,b,c){(function(){b.exports=function(){return Handlebars.parseHTML(document.body.childNodes)}}).call(this)},{}],7:[function(a,b,c){(function(){b.exports=function(){var a;return a=Handlebars.parseValue,Handlebars.parseValue=function(b){return function(c,d){var e;return c=a.apply(b,[c,d]),c&&(e=Hipbone.Model.prototype.identityMap.find(c.cid)||Hipbone.Collection.prototype.identityMap.find(c.cid))&&(c=e),c}}(this)}}).call(this)},{}],8:[function(a,b,c){(function(){b.exports=function(){var a;return a=Backbone.sync,Backbone.sync=function(b){return function(c,d,e){return null==e&&(e={}),e.sync=!0,e.url||(e.url=d.url(e)),e=b.ajaxSettings(e),b.ajaxHandle(a.apply(b,[c,d,e]))}}(this)}}).call(this)},{}],9:[function(a,b,c){(function(){b.exports=function(){return $("body").on("submit","form:not([bypass])",function(a){return a.preventDefault()})}}).call(this)},{}],10:[function(require,module,exports){(function(){var slice=[].slice;module.exports=function(){var eachHelper,ifHelper;return Handlebars.registerHelper("asset",function(a){return function(b,c){return null==c&&(c={}),a.get("assets")[b]}}(this)),Handlebars.registerHelper("t",function(a){return function(b,c){return null==c&&(c={}),a.i18n.t(b,c.hash)}}(this)),Handlebars.registerHelper("url",function(a){return function(b,c){return null==c&&(c={}),a.router.url(b,c.hash)}}(this)),Handlebars.registerHelper("fmt",function(){var a,b,c,d,e;return e=arguments[0],a=3<=arguments.length?slice.call(arguments,1,b=arguments.length-1):(b=1,[]),d=arguments[b++],null==d&&(d={}),c=0,e.replace(/%@/g,function(b){return a[c++]})}),Handlebars.registerHelper("eval",function(javascript,options){return null==options&&(options={}),eval(javascript)}),Handlebars.registerHelper("template",function(a,b){var c,d;return null==b&&(b={}),c=_.isEmpty(b.hash)?this:b.hash,d=Hipbone.View.prototype.getTemplate(a)(c),b.hash.unescape?d:new Handlebars.SafeString(d)}),eachHelper=Handlebars.helpers.each,Handlebars.registerHelper("each",function(a,b){return null==b&&(b={}),a&&(a=a.models||a),eachHelper.apply(this,[a,b])}),ifHelper=Handlebars.helpers["if"],Handlebars.registerHelper("if",function(a,b){var c;return null==b&&(b={}),b.hash.bind&&(null!=(c=_.path(this,a))?c.models:void 0)?a+=".models":a&&(a=a.models||a),ifHelper.apply(this,[a,b])})}}).call(this)},{}],11:[function(a,b,c){(function(){b.exports={initializeLocale:function(a){return null==a&&(a="en"),this.locale||(this.locale=a),this.locales||(this.locales={}),this.i18n=new Hipbone.I18n(this.locale,this.locales)}}}).call(this)},{}],12:[function(a,b,c){(function(){b.exports={locales:{},initializeLocales:function(a,b){return null==a&&(a="en"),null==b&&(b={}),this.locale||(this.locale=a),this.locales=_.extend({},this.locales,b),this.i18n=new Hipbone.I18n(this.locale,this.locales)}}}).call(this)},{}],13:[function(a,b,c){(function(){b.exports={initializeState:function(a){return null==a&&(a={}),this.state=new(Hipbone.Model.define({defaults:this.defaults}))(a),this.listenTo(this.state,"all",function(a){return function(){return a.trigger.apply(a,arguments)}}(this))},get:function(){return this.state.get.apply(this.state,arguments)},set:function(){return this.state.set.apply(this.state,arguments)}}}).call(this)},{}],14:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;d=a("./model"),e=a("./module"),b.exports=c=function(b){function c(a,b){var d;return null==b&&(b={}),_.isArray(a)||(b=a||{},a=void 0),(d=this.initializeStore(a,b))?d:(this.cid=_.uniqueId("collection"),this.initializeMeta(b.meta),this.initializeParent(b.parent),this.initializeFilters(),this.initializePagination(),c.__super__.constructor.apply(this,arguments),this.on("add remove reset sort",function(a){return function(){return a.trigger("update",a)}}(this)),this.on("all",function(a){return function(){return a.store()}}(this)),void this.store())}return f(c,b),_.extend(c,e),c.include(a("./collection/sync")),c.include(a("./collection/meta")),c.include(a("./collection/store")),c.include(a("./collection/parent")),c.include(a("./collection/filters")),c.include(a("./collection/populate")),c.include(a("./collection/pagination")),c.include(a("./collection/polymorphic")),c.prototype.model=d,c.prototype._prepareModel=function(a,b){var d;return null==b&&(b={}),(d=this.preparePolymorphic(a,b))&&(a=d),c.__super__._prepareModel.call(this,a,b)},c.prototype.modelId=function(a){return void 0},c.prototype.url=function(a){var b,c;return b=this.toJSONFilters(a),c=this.parentUrl(a),_.isEmpty(b)||(c=c+"?"+$.param(b)),c},c.prototype.toJSON=function(a){var b;return null==a&&(a={}),b=c.__super__.toJSON.apply(this,arguments),a.sync||(b=_.extend({cid:this.cid,length:this.length,meta:this.meta.toJSON(),models:b})),b},c.prototype.parse=function(a){return null==a&&(a={}),this.didSync(),a.meta&&this.meta.set(a.meta),a.models||a},c.register("Collection"),c}(Backbone.Collection)}).call(this)},{"./collection/filters":15,"./collection/meta":16,"./collection/pagination":17,"./collection/parent":18,"./collection/polymorphic":19,"./collection/populate":20,"./collection/store":21,"./collection/sync":22,"./model":26,"./module":34}],15:[function(a,b,c){(function(){b.exports={initializeFilters:function(){return this.filters||(this.filters={})},toJSONFilters:function(a){var b,c,d,e;null==a&&(a={}),c={},d=this.filters;for(b in d)e=d[b],_.isFunction(e)&&(e=e.apply(this,[a])),null!=e&&(c[b]=e);return c}}}).call(this)},{}],16:[function(a,b,c){(function(){var a=[].slice;b.exports={initializeMeta:function(b){return null==b&&(b={}),this.meta=new(Hipbone.Model.define({defaults:this.defaults}))(b),this.listenTo(this.meta,"all",function(b){return function(){var c,d;return d=arguments[0],c=2<=arguments.length?a.call(arguments,1):[],b.trigger.apply(b,["meta:"+d].concat(a.call(c)))}}(this))}}}).call(this)},{}],17:[function(a,b,c){(function(){b.exports={initializePagination:function(){return this.pagination||(this.pagination={}),this.paginationOffset=this.pagination.offset,this.filters||(this.filters={}),this.filters.limit=function(a){return null==a&&(a={}),null!=this.paginationOffset?a.paginate?this.pagination.limit:this.pagination.limit+this.paginationOffset:void 0},this.filters.offset=function(a){return null==a&&(a={}),null!=this.paginationOffset?a.paginate?this.paginationOffset:0:void 0}},incrementPagination:function(){return this.paginationOffset=this.paginationOffset+this.pagination.limit},decrementPagination:function(){return this.paginationOffset=this.paginationOffset-this.pagination.limit},paginate:function(a){return null==a&&(a={}),this.incrementPagination(),this.fetch(_.extend({remove:!1,paginate:!0},a))},hasMore:function(){return this.length<this.getPaginationCount()},getPaginationCount:function(){return this.meta.get("count")}}}).call(this)},{}],18:[function(a,b,c){(function(){b.exports={initializeParent:function(a){return this.parent=a},setParent:function(a,b){return null==b&&(b={}),this.parent===a||(this.parent=a,b.silent)?void 0:this.trigger("change:parent",this.parent)},parentUrl:function(a){return null==a&&(a={}),this.parent?""+this.parent.url(a)+this.urlRoot:this.urlRoot}}}).call(this)},{}],19:[function(a,b,c){(function(){b.exports={preparePolymorphic:function(a,b){var c,d,e,f;if(null==b&&(b={}),!this._isModel(a)&&_.isArray(this.model))for(f=this.model,d=0,e=f.length;e>d;d++)if(c=f[d],c.prototype.moduleName===this.polymorphicType(a))return delete a[this.polymorphicTypeAttribute(a)],new c(a,b)},polymorphicType:function(a){return null==a&&(a={}),a[this.polymorphicTypeAttribute(a)]},polymorphicTypeAttribute:function(a){return null==a&&(a={}),"type"}}}).call(this)},{}],20:[function(a,b,c){(function(){b.exports={populated:function(a){return this.synced},populate:function(a){return this.fetch()},prepare:function(a){return $.when(this.populated(a)||this.populate(a))}}}).call(this)},{}],21:[function(a,b,c){(function(){var c;c=a("./../identity_map"),b.exports={included:function(){var a;return(a=this.prototype).identityMap||(a.identityMap=new c)},registered:function(){return this.prototype.hashName=_.string.dasherize(this.prototype.moduleName).substring(1)},initializeStore:function(a,b){var c,d;return d=this.hashes(a,b),(c=this.identityMap.findAll(d)[0])?(a&&c.set(a,b),b.meta&&c.meta.set(b.meta),b.parent&&c.setParent(b.parent),c):(this.store(d),null)},hashes:function(a,b){var c,d;return null==b&&(b={}),c=[],this.cid&&c.push(this.cid),(null!=(d=b.parent)?d.cid:void 0)&&c.push(this.hashName+"-"+b.parent.cid),c},store:function(a){return a||(a=this.hashes(this.models,{parent:this.parent,meta:this.meta})),this.identityMap.storeAll(a,this)}}}).call(this)},{"./../identity_map":25}],22:[function(a,b,c){(function(){b.exports={unsync:function(){return delete this.synced,this.trigger("unsync",this)},didSync:function(){return this.synced=Date.now(),this.trigger("synced",this)}}}).call(this)},{}],23:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d=a("./module"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),_.extend(b,d),b.prototype.route=function(a,b){return this.handlers.push({route:a,callback:b})},b.prototype.reload=function(a){return a?this.location.assign(a):this.location.reload()},b.prototype.change=function(a){var b,c,d;for(c in a)d=a[c],null==d&&delete a[c];return b=this.location.pathname,_.isEmpty(a)||(b+="?"+$.param(a)),this.history.replaceState({},document.title,b)},b.prototype.parameters=function(){var a,b,c,d,e,f;for(d={},e=/([^&=]+)=?([^&]*)/g;b=e.exec(this.location.search.substring(1));)c=b[0],a=b[1],f=b[2],d[this.decode(a)]=_.parse(this.decode(f));return d},b.prototype.decode=function(a){return decodeURIComponent(a.replace(/\+/g," "))},b.prototype.checkUrl=function(a){return this.popstate=!0,b.__super__.checkUrl.apply(this,arguments),this.popstate=!1},b.register("History"),b}(Backbone.History)}).call(this)},{"./module":34}],24:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d=a("./module"),b.exports=c=function(a){function b(a,b,c){null==b&&(b={}),this.locale=a,this.locales=b,this.splitter=c||/{{\w+}}/g}return e(b,a),b.prototype.interpolate=function(a,b){var c,d,e,f,g;for(null==b&&(b={}),f=a.match(this.splitter)||[],c=0,d=f.length;d>c;c++)e=f[c],g=b[e.replace(/\W/g,"")],a=a.replace(e,g);return a},b.prototype.pluralize=function(a,b){return a+=0===b?".zero":1===b?".one":".other",_.path(this.locales[this.locale],a)},b.prototype.inflector=function(a,b){return a+="m"===b?".male":"f"===b?".female":".neutral",_.path(this.locales[this.locale],a)},b.prototype.translate=function(a,b){var c;return null==b&&(b={}),c=_.has(b,"count")?this.pluralize(a,b.count):_.has(b,"gender")?this.inflector(a,b.gender):_.path(this.locales[this.locale],a),this.interpolate(c,b)},b.prototype.t=b.prototype.translate,b.register("I18n"),b}(d)}).call(this)},{"./module":34}],25:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d=a("./module"),b.exports=c=function(a){function b(){this.instances={}}return e(b,a),b.prototype.match=function(a){var b,c,d,e;d={},e=this.instances;for(c in e)b=e[c],a.test(c)&&(d[c]=b);return d},b.prototype.find=function(a){var b;return(b=this.instances[a])&&this.store(a,b),b},b.prototype.findAll=function(a){var b,c,d,e,f;for(f=[],b=0,d=a.length;d>b;b++)c=a[b],(e=this.find(c))&&f.push(e);return f},b.prototype.store=function(a,b,c){return null==c&&(c={}),this.instances[a]=b},b.prototype.storeAll=function(a,b){var c,d,e,f;for(f=[],c=0,e=a.length;e>c;c++)d=a[c],f.push(this.store(d,b));return f},b.prototype["delete"]=function(a){return delete this.instances[a]},b.prototype.deleteAll=function(a){var b,c,d,e;for(e=[],b=0,d=a.length;d>b;b++)c=a[b],e.push(this["delete"](c));return e},b.prototype.clear=function(){return this.deleteAll(_.keys(this.instances))},b.register("IdentityMap"),b}(d)}).call(this)},{"./module":34}],26:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;d=a("./module"),b.exports=c=function(b){function c(a,b){var d;return null==a&&(a={}),null==b&&(b={}),(d=this.initializeStore(a,b))?d:(this.initializeMappings(),this.initializeValidations(),this.initializeComputedAttributes(),c.__super__.constructor.apply(this,arguments),this.on("all",function(a){return function(){return a.store()}}(this)),void this.store())}return e(c,b),_.extend(c,d),c.include(a("./model/sync")),c.include(a("./model/store")),c.include(a("./model/mappings")),c.include(a("./model/populate")),c.include(a("./model/validations")),c.include(a("./model/nested_attributes")),c.include(a("./model/computed_attributes")),c.prototype.cidPrefix="model",c.prototype.get=function(a){return this.mappings[a]?this.getMapping(a):this.computedAttributes[a]?this.getComputedAttribute(a):this.getNestedAttribute(a)},c.prototype.set=function(a,b,d){var e;return null==d&&(d={}),_.isObject(a)?(e=a,d=b||{}):(e={},e[a]=b),this.setMappings(e,d),this.setNestedAttributes(e,d),c.__super__.set.call(this,e,d),this.nestedChangeTrigger(d)},c.prototype.toJSON=function(a){var b,d,e,f,g;null==a&&(a={}),g=a.mappings||{};for(e in g)f=g[e],f.sync=a.sync;return b=a.computedAttributes||_.keys(this.computedAttributes),d=_.deepClone(c.__super__.toJSON.apply(this,arguments)),a.sync||(d=_.extend({cid:this.cid},d,this.toJSONComputedAttributes(b),this.toJSONMappings(g))),d},c.prototype.parse=function(a){return null==a&&(a={}),this.didSync(),a},c.register("Model"),c}(Backbone.Model)}).call(this)},{"./model/computed_attributes":27,"./model/mappings":28,"./model/nested_attributes":29,"./model/populate":30,"./model/store":31,"./model/sync":32,"./model/validations":33,"./module":34}],27:[function(a,b,c){(function(){b.exports={initializeComputedAttributes:function(){return this.computedAttributes||(this.computedAttributes={})},getComputedAttribute:function(a){var b;return b=this.computedAttributes[a],_.isFunction(b)||(b=this[b]),b?b.apply(this):void 0},setComputedAttribute:function(a,b){var c;return c=this.computedAttributes[a],_.isFunction(c)||(c=this[c]),c?c.apply(this,[b]):void 0},toJSONComputedAttributes:function(a){var b,c,d,e;for(null==a&&(a=[]),d={},c=0,e=a.length;e>c;c++)b=a[c],d[b]=this.getComputedAttribute(b);return d}}}).call(this)},{}],28:[function(a,b,c){(function(){b.exports={initializeMappings:function(){return this.transients={},this.mappings||(this.mappings={})},mappingIdAttribute:function(a){return a+"_"+this.parseMappingIdAttribute(a)},mappingTypeAttribute:function(a){return a+"_"+this.parseMappingTypeAttribute(a)},mappingId:function(a,b){return null==b&&(b={}),b[this.mappingIdAttribute(a)]},mappingType:function(a,b){return null==b&&(b={}),b[this.mappingTypeAttribute(a)]},parseMappingIdAttribute:function(a){return"id"},parseMappingTypeAttribute:function(a){return"type"},parseMappingId:function(a,b){return null==b&&(b={}),b[this.parseMappingIdAttribute(a)]},parseMappingType:function(a,b){return null==b&&(b={}),b[this.parseMappingTypeAttribute(a)]},getMapping:function(a){var b,c,d,e,f,g,h,i,j;if(c=this.mappings[a].apply(this),j=_.isArray(c))for(f=0,h=c.length;h>f;f++)b=c[f],b.prototype.moduleName===this.mappingType(a,this.attributes)&&(c=b);return c.prototype instanceof Hipbone.Model?(d={},(g=this.mappingId(a,this.attributes))&&(d[this.parseMappingIdAttribute(a)]=g),_.isEmpty(d)||(i=new c(d))):c.prototype instanceof Hipbone.Collection&&(e=new c({parent:this})),i||e||this.transients[a]},setMapping:function(a,b,c){var d,e,f,g,h,i,j,k,l;if(null==c&&(c={}),e=this.mappings[a].apply(this),l=_.isArray(e)&&b)for(g=0,h=e.length;h>g;g++)d=e[g],d.prototype.moduleName===this.parseMappingType(a,b)&&(e=d);return b instanceof Hipbone.Model?j=b:b instanceof Hipbone.Collection&&(f=b,f.setParent(this)),j||f||(e.prototype instanceof Hipbone.Model&&b?(delete b[this.parseMappingTypeAttribute(a)],j=new e(b,c)):e.prototype instanceof Hipbone.Collection&&(_.isArray(b)?k=b:_.isObject(b)&&(i=b.meta,k=b.models),f=new e(k,_.extend(c,{parent:this,meta:i})))),j?(this.set(this.mappingIdAttribute(a),this.parseMappingId(a,j.attributes)),l&&this.set(this.mappingTypeAttribute(a),j.moduleName),j.isNew()&&(this.transients[a]=j)):f?this.transients[a]=f:(delete this.transients[a],this.unset(this.mappingIdAttribute(a)),this.unset(this.mappingTypeAttribute(a))),j||f},setMappings:function(a){var b,c,d,e;null==a&&(a={}),c=_.pick(a,_.keys(this.mappings)),d=[];for(b in c)e=c[b],this.setMapping(b,e,{parse:!0}),d.push(delete a[b]);return d},toJSONMappings:function(a){var b,c,d,e;null==a&&(a={}),b={};for(c in a)d=a[c],b[c]=null!=(e=this.getMapping(c))?e.toJSON(d):void 0;return b}}}).call(this)},{}],29:[function(a,b,c){(function(){b.exports={getNestedAttribute:function(a){return _.path(this.attributes,a)},setNestedAttribute:function(a,b,c){var d,e,f,g,h,i,j,k;if(null==c&&(c={}),h=a.split("."),!_.isEqual(this.get(a),b)&&(f={},f[a]=b,i=this.get(a),this.attributes=_.pathExtend(this.attributes,f),!c.silent)){for(j=_.clone(h).reverse(),k=[],d=0,e=j.length;e>d;d++)g=j[d],a=h.join("."),h.pop(),this.nestedChanged[a]=b,k.push(this.trigger("change:"+a,this,i,c));return k}},setNestedAttributes:function(a,b){var c,d,e;null==a&&(a={}),null==b&&(b={}),this.nestedChanged={},d=[];for(c in a)e=a[c],c.split(".").length>1&&(this.setNestedAttribute(c,e,b),d.push(delete a[c]));return d},nestedChangeTrigger:function(a){return 0===_.keys(this.changed).length&&0!==_.keys(this.nestedChanged).length?this.trigger("change",this,a):void 0}}}).call(this)},{}],30:[function(a,b,c){arguments[4][20][0].apply(c,arguments)},{dup:20}],31:[function(a,b,c){(function(){var c;c=a("./../identity_map"),b.exports={included:function(){var a;return(a=this.prototype).identityMap||(a.identityMap=new c)},registered:function(){return this.prototype.hashName=_.string.dasherize(this.prototype.moduleName).substring(1)},initializeStore:function(a,b){var c,d;return null==a&&(a={}),null==b&&(b={}),c=this.hashes(a),(d=this.identityMap.findAll(c)[0])?(d.set(a,b),d):(this.store(c),null)},hashes:function(a){var b;return b=[],this.cid&&b.push(this.cid),a[this.idAttribute]&&b.push(this.hashName+"-"+a[this.idAttribute]),b},store:function(a){return a||(a=this.hashes(this.attributes)),this.identityMap.storeAll(a,this)}}}).call(this)},{"./../identity_map":25}],32:[function(a,b,c){arguments[4][22][0].apply(c,arguments)},{dup:22}],33:[function(a,b,c){(function(){b.exports={initializeValidations:function(){return this.errors=[],this.validations||(this.validations={})},hasErrors:function(a){return null==a&&(a=[]),_.isEmpty(a)?this.errors.length>0:_.intersection(this.errors,a).length>0},validate:function(a){var b,c,d;null==a&&(a={}),this.errors=[];for(b in a)d=a[b],c=this.validations[b],c&&!c.apply(this,[d,a])&&this.errors.push(b);return this.hasErrors()?this.errors:void 0}}}).call(this)},{}],34:[function(a,b,c){(function(){var a,c,d,e=[].slice,f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};window._modules||(window._modules={}),c=["included","extended"],d=function(a){var b,c;return c=a.__super__.constructor,b=_.uniqueId("module"),_modules[b]=a,a.cid=b,a.subclasses=[],a.includedModules=_.clone(c.includedModules||[]),a.extendedModules=_.clone(c.extendedModules||[]),c.subclasses?c.subclasses.push(a):void 0},b.exports=a=function(){function a(){}return a.prototype.moduleName="Module",a.register=function(a){var b,c,e,f,g,h,i,j;for(_modules[this.cid]!==this&&d(this),this.prototype.moduleName=a,h=this.includedModules,b=0,e=h.length;e>b;b++)g=h[b],g.registered&&g.registered.apply(this);for(i=this.extendedModules,j=[],c=0,f=i.length;f>c;c++)g=i[c],g.registered&&j.push(g.registered.apply(this));return j},a.include=function(){var a,b,g,h,i,j,k;for(i=1<=arguments.length?e.call(arguments,0):[],_modules[this.cid]!==this&&d(this),k=[],a=0,b=i.length;b>a;a++){h=i[a],this.includedModules.push(h);for(j in h)g=h[j],f.call(c,j)<0&&(this.prototype[j]=g);h.included&&h.included.apply(this),h.registered?k.push(h.registered.apply(this)):k.push(void 0)}return k},a.extend=function(){var a,b,g,h,i,j,k;for(i=1<=arguments.length?e.call(arguments,0):[],_modules[this.cid]!==this&&d(this),k=[],a=0,b=i.length;b>a;a++){h=i[a],this.extendedModules.push(h);for(j in h)g=h[j],f.call(c,j)<0&&(this[j]=g);h.extended&&h.extended.apply(this),h.registered?k.push(h.registered.apply(this)):k.push(void 0)}return k},a.define=Backbone.Model.extend,a}()}).call(this)},{}],35:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;c=a("./module"),b.exports=d=function(b){function c(a,b){var c;return null==a&&(a={}),null==b&&(b={}),(c=this.initializeStore(a,b))?c:(this.cid=_.uniqueId("route"),this.initializeTitle(b.titleRoot),this.initializeElement(b.elementRoot),this.initializeParameters(a),this.initialize(a),this.on("all",function(a){return function(){return a.store()}}(this)),this.prepare(),void this.store())}return e(c,b),c.include(Backbone.Events),c.include(a("./route/store")),c.include(a("./route/title")),c.include(a("./route/element")),c.include(a("./route/populate")),c.include(a("./route/parameters")),c.prototype.initialize=function(a){null==a&&(a={})},c.prototype.beforeActivate=function(){return!0},c.prototype.activate=function(){return this.renderTitle(),this.renderElement()},c.register("Route"),c}(c)}).call(this)},{"./module":34,"./route/element":36,"./route/parameters":37,"./route/populate":38,"./route/store":39,"./route/title":40}],36:[function(a,b,c){(function(){var a;a=void 0,b.exports={initializeElement:function(a){return this.elementRoot||(this.elementRoot=a||document.body)},element:function(){},renderElement:function(){return this._element||(this._element=this.element()),a!==this._element?($(a).detach(),this.elementRoot.hipboneView?this.elementRoot.hipboneView.setContent(this._element):$(this.elementRoot).append(this._element),a=this._element):void 0}}}).call(this)},{}],37:[function(a,b,c){(function(){b.exports={initializeParameters:function(a){return null==a&&(a={}),this.parse=_.bind(this.parse,this),this.params=this.parameters=new(Hipbone.Model.define({defaults:this.defaults,parse:this.parse}))(a,{parse:!0}),this.listenTo(this.params,"all",function(a){return function(){return a.trigger.apply(a,arguments)}}(this))},get:function(){return this.params.get.apply(this.params,arguments)},set:function(){return this.params.set.apply(this.params,arguments)},parse:function(a){return null==a&&(a={}),a}}}).call(this)},{}],38:[function(a,b,c){(function(){b.exports={populated:function(a){return!1},populate:function(a){return $.when(!0)},prepare:function(a){return $.when(this.populated(a)||this.populate(a))}}}).call(this)},{}],39:[function(a,b,c){(function(){var c;c=a("./../identity_map"),b.exports={included:function(){var a;return(a=this.prototype).identityMap||(a.identityMap=new c)},registered:function(){return this.prototype.hashName=_.string.dasherize(this.prototype.moduleName).substring(1)},initializeStore:function(a,b){var c,d;return null==a&&(a={}),null==b&&(b={}),c=this.hashes(a,b),this.identityMap.find(b.path)&&!b.popstate&&(c=_.without(c,b.path)),(d=this.identityMap.findAll(c)[0])?(d.set(a),d):(this.store(c),null)},hashes:function(a,b){var c;return null==a&&(a={}),null==b&&(b={}),c=[],this.cid&&c.push(this.cid),c.push(b.path),c},store:function(a){return a||(a=this.hashes(this.params.attributes)),this.identityMap.storeAll(a,this)}}}).call(this)},{"./../identity_map":25}],40:[function(a,b,c){(function(){b.exports={initializeTitle:function(a){return null==a&&(a=""),this.titleRoot||(this.titleRoot=a)},subtitle:function(){return""},title:function(){var a;return a=this.subtitle(),_.string.isBlank(a)?this.titleRoot:a+" - "+this.titleRoot},renderTitle:function(){return document.title=this.title()}}}).call(this)},{}],41:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;d=a("./module"),c=a("./history"),b.exports=e=function(b){function e(a){null==a&&(a={}),this.title||(this.title=a.title||"App"),this.initializeMatches(),e.__super__.constructor.apply(this,arguments)}return f(e,b),_.extend(e,d),e.include(a("./router/url")),e.include(a("./router/matches")),e.prototype.history=Backbone.history=new c,e.prototype.navigate=function(a,b){return null==b&&(b={}),a=this.urlFragment(a,b.params),b.reload?this.history.reload(a):b.load?this.history.loadUrl(a):e.__super__.navigate.call(this,a,b)},e.prototype.start=function(){return Backbone.History.started?void 0:this.history.start({pushState:!0})},e.register("Router"),e}(Backbone.Router)}).call(this)},{"./history":23,"./module":34,"./router/matches":42,"./router/url":43}],42:[function(a,b,c){(function(){b.exports={initializeMatches:function(){return this.matches||(this.matches={})},match:function(a,b){var c,d;return null==b&&(b={}),this.matches[a]=b,d=b.url,c=b.route,this.route(d,a,function(){var a,b,e,f,g,h;for(g=this.history.parameters(),h=d.match(/:\w+/g)||[],b=a=0,e=h.length;e>a;b=++a)f=h[b],arguments[b]&&(g[f.substring(1)]=_.parse(arguments[b]));return this._route=new c(g,{title:this.title,path:this.history.location.pathname,popstate:this.history.popstate}),this._route.beforeActivate()?this._route.activate():void 0})}}}).call(this)},{}],43:[function(a,b,c){(function(){b.exports={url:function(a,b){return this.matches[a].toURL(b)},urlFragment:function(a,b){var c;return this.matches[a]&&(a=this.url(a,b)),c=$("<a>").attr("href",a).get(0),b&&(c.search=$.param(b)),a=c.pathname+c.search}}}).call(this)},{}],44:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;c=a("./module"),b.exports=d=function(a){function b(a){null==a&&(a="hipbone_"),this.prefix=a}return e(b,a),b.prototype.match=function(a){var b,c,d;c={};for(b in localStorage)d=localStorage[b],a.test(b)&&(c[b.replace(this.prefix,"")]=JSON.parse(d));return c},b.prototype.get=function(a){var b;return(b=localStorage[""+this.prefix+a])?_.parse(b):void 0},b.prototype.set=function(a,b){return localStorage.setItem(""+this.prefix+a,JSON.stringify(b))},b.prototype.unset=function(a){return localStorage.removeItem(""+this.prefix+a)},b.prototype.clear=function(){var a,b,c,d,e;c=new RegExp(this.prefix),b=this.match(c),d=[];for(a in b)e=b[a],d.push(this.unset(a));return d},b.register("Storage"),b}(c)}).call(this)},{"./module":34}],45:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;c=a("./module"),b.exports=d=function(b){function d(a,b){var c;return null==a&&(a={}),null==b&&(b={}),(c=this.initializeStore(a))?c:(this.initializeContext(),
this.initializeContent(b.content),this.initializePopulate(),this.initializeTemplate(),this.initializeElements(),this.initializeProperties(a),this.initializeClassNameBindings(),d.__super__.constructor.call(this,b),this.on("change",function(a){return function(){return a.update()}}(this)),this.on("all",function(a){return function(){return a.store()}}(this)),this.lifecycle(),this.prepare(),this.render(),void this.store())}return e(d,b),_.extend(d,c),d.include(Backbone.Events),d.include(a("./view/store")),d.include(a("./view/bubble")),d.include(a("./view/content")),d.include(a("./view/context")),d.include(a("./view/populate")),d.include(a("./view/elements")),d.include(a("./view/template")),d.include(a("./view/lifecycle")),d.include(a("./view/properties")),d.include(a("./view/class_name_bindings")),d.prototype.destroy=function(){},d.prototype._setElement=function(){return this.defineElement(d.__super__._setElement.apply(this,arguments))},d.prototype._setAttributes=function(a){return null==a&&(a={}),d.__super__._setAttributes.call(this,this.mergeAttributes(a))},d.prototype.$=function(a){return d.__super__.$.call(this,this.getSelector(a))},d.prototype.update=function(){return this.updateContextBindings(),this.updateClassNameBindings()},d.prototype.render=function(){return this.update(),this.renderTemplate(),this.renderContent()},d.prototype.delegate=function(a,b,c){return d.__super__.delegate.call(this,a,this.getSelector(b),c)},d.prototype.remove=function(){return this.destroy(),d.__super__.remove.apply(this,arguments)},d.register("View"),d}(Backbone.View)}).call(this)},{"./module":34,"./view/bubble":47,"./view/class_name_bindings":48,"./view/content":49,"./view/context":50,"./view/elements":51,"./view/lifecycle":52,"./view/populate":53,"./view/properties":54,"./view/store":55,"./view/template":56}],46:[function(a,b,c){(function(){b.exports={setAttribute:function(a,b){if(a=_.string.dasherize(a),"class"===a)return this.$el.addClass(b);if(_.contains(this.booleans,a)){if(b)return this.$el.attr(a,"")}else if(!_.isObject(b))return this.$el.attr(a,b)}}}).call(this)},{}],47:[function(a,b,c){(function(){var a=[].slice;b.exports={bubble:function(){var b,c;return c=arguments[0],b=2<=arguments.length?a.call(arguments,1):[],this.trigger.apply(this,arguments),this.$el.trigger(c,b)}}}).call(this)},{}],48:[function(a,b,c){(function(){b.exports={initializeClassNameBindings:function(){return this.classNameBindings||(this.classNameBindings={})},updateClassNameBindings:function(){var a,b,c,d,e,f;this._classNameBindings||(this._classNameBindings={}),d=this.classNameBindings,e=[];for(b in d)a=d[b],c=this._classNameBindings[b],f=this._classNameBindings[b]=a.apply(this),_.isBoolean(f)?f?e.push(this.$el.addClass(b)):e.push(this.$el.removeClass(b)):f!==c?(this.$el.removeClass(c),e.push(this.$el.addClass(f))):e.push(void 0);return e}}}).call(this)},{}],49:[function(a,b,c){(function(){b.exports={initializeContent:function(a){return this.content=a,this.container||(this.container=void 0)},setContent:function(a){return this.content!==a?(this.content=a,this.renderContent()):void 0},renderContent:function(){return this.content?this.container?this.$(this.container).append(this.content):this.$el.append(this.content):void 0}}}).call(this)},{}],50:[function(a,b,c){(function(){b.exports={initializeContext:function(){return this._context={}},context:function(){return{}},getContext:function(a){return null==a&&(a={}),_.isEmpty(a)?this._context:this.presentContext(a)},presentContext:function(a){var b,c,d;null==a&&(a={}),c=a=_.defaults(a,this.properties.attributes);for(b in c)d=c[b],(d instanceof Hipbone.Model||d instanceof Hipbone.Collection)&&(a[b]=d.toJSON());return a},mergeContext:function(a){return null==a&&(a={}),jsondiffpatch.patch(this._context,jsondiffpatch.diff(this._context,a))},updateContextBindings:function(){return this.mergeContext(this.presentContext(this.context())),Platform.performMicrotaskCheckpoint()}}}).call(this)},{}],51:[function(a,b,c){(function(){var a;a=function(a,b){var c,d,e;null==a&&(a={}),null==b&&(b=[]),c=[];for(d in a)e=a[d],_.isBoolean(e)&&!_.contains(b,d)&&c.push(_.string.dasherize(d));return c},b.exports={registered:function(){var b;return this.prototype.elementName=_.string.dasherize(this.prototype.moduleName).substring(1).replace("-view",""),this.prototype.booleans=a(this.prototype.defaults,this.prototype.internals),b=this,Handlebars.registerElement(this.prototype.elementName,function(a){return new b(a,{content:$(this).contents()}).el},{booleans:this.prototype.booleans})},initializeElements:function(){return this.elementName||(this.elementName=""),this.elements||(this.elements={}),this.booleans||(this.booleans=[])},getSelector:function(a){return this.elements[a]||a},defineElement:function(){return this.el.hipboneView=this,this.el},$view:function(a){return this.$(a)[0]?this.$(a)[0].hipboneView:void 0}}}).call(this)},{}],52:[function(a,b,c){(function(){b.exports={insert:function(){},detach:function(){},change:function(a,b){},lifecycle:function(){return this.$el.lifecycle({insert:function(a){return function(){return a.insert(),a.trigger("insert")}}(this),remove:function(a){return function(){return a.detach(),a.trigger("detach")}}(this),change:function(a){return function(b,c){var d;return a.change(b,c),d=_.string.camelize(b),_.contains(a.internals,d)?void 0:a.set(d,Handlebars.parseValue(c,_.contains(a.booleans,b)))}}(this)})}}}).call(this)},{}],53:[function(a,b,c){(function(){b.exports={initializePopulate:function(){var a,b;return this.background||(this.background=!1),this.defaults||(this.defaults={}),this.defaults.loading=!1,this.internals||(this.internals=[]),this.internals.push("loading"),b=this.populated,this.populated=function(){return this.background||b.apply(this,arguments)},a=this.populate,this.populate=function(){return this.background?a.apply(this,arguments):(this.set({loading:!0}),a.apply(this,arguments).done(function(a){return function(){return a.set({loading:!1})}}(this)))}},populated:function(a){return!1},populate:function(a){return $.when(!0)},prepare:function(a){return $.when(this.populated(a)||this.populate(a))}}}).call(this)},{}],54:[function(a,b,c){(function(){b.exports={initializeProperties:function(a){return null==a&&(a={}),this.internals||(this.internals=[]),this.props=this.properties=new(Hipbone.Model.define({defaults:this.defaults}))(_.omit(a,this.internals)),this.listenTo(this.props,"change",function(a){return function(){return a.trigger("change")}}(this))},get:function(){return this.props.get.apply(this.props,arguments)},set:function(){return this.props.set.apply(this.props,arguments)},mergeAttributes:function(a){var b,c,d;null==a&&(a={}),c=this.properties.attributes;for(b in c)d=c[b],_.contains(this.internals,b)||(b=_.string.dasherize(b),"class"===b?a[b]=(a[b]+" "+d).trim():_.contains(this.booleans,b)?d&&(a[b]=""):_.isObject(d)||(a[b]=d));return a}}}).call(this)},{}],55:[function(a,b,c){(function(){var c;c=a("./../identity_map"),b.exports={included:function(){var a;return(a=this.prototype).identityMap||(a.identityMap=new c)},registered:function(){return this.prototype.hashName=_.string.dasherize(this.prototype.moduleName).substring(1)},initializeStore:function(a){var b,c;return null==a&&(a={}),b=this.hashes(a),(c=this.identityMap.findAll(b)[0])?(c.setContent(content),c.set(a),c):(this.store(b),null)},hashes:function(a){var b;return null==a&&(a={}),b=[],this.cid&&b.push(this.cid),b},store:function(a){return a||(a=this.hashes()),this.identityMap.storeAll(a,this)}}}).call(this)},{"./../identity_map":25}],56:[function(a,b,c){(function(){b.exports={initializeTemplate:function(){return this.templates||(this.templates={}),this.templatePath||(this.templatePath=""),this.templateName||(this.templateName="")},template:function(a,b){return $(Handlebars.parseHTML(this.getTemplate(a)(this.getContext(b))))},getTemplate:function(a){return this.templates[""+this.templatePath+a]},renderTemplate:function(){return this.templateName?this.$el.html(this.template(this.templateName)):void 0}}}).call(this)},{}],57:[function(a,b,c){(function(){b.exports={initializeTemplates:function(a,b,c){return null==a&&(a=""),null==c&&(c={}),this.templatePath||(this.templatePath=a),this.templateName||(this.templateName=b),this.templates=_.extend({},this.templates,c)},template:function(a,b){return $(Handlebars.parseHTML(this.getTemplate(a)(this.getContext(b))))},getTemplate:function(a){return this.templates[""+this.templatePath+a]},renderTemplate:function(){return this.templateName?this.$el.html(this.template(this.templateName)):void 0}}}).call(this)},{}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57]);